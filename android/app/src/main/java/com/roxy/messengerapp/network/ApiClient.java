package com.roxy.messengerapp.network;import android.content.Context;import android.content.SharedPreferences;import okhttp3.Interceptor;import okhttp3.OkHttpClient;import okhttp3.Request;import okhttp3.logging.HttpLoggingInterceptor;import retrofit2.Retrofit;import retrofit2.converter.gson.GsonConverterFactory;public class ApiClient {    // ВАЖНО: поменяй на свой IP (10.0.2.2 для эмулятора, или реальный IP для телефона)    private static final String BASE_URL = "https://e1e5-2a0d-b201-5000-ed50-798f-23b3-80ea-24f5.ngrok-free.app/";    private static ApiService apiService;    private static String authToken;    public static void init(Context context) {        SharedPreferences prefs = context.getSharedPreferences("auth", Context.MODE_PRIVATE);        authToken = prefs.getString("token", null);    }    public static ApiService getApi() {        if (apiService == null) {            HttpLoggingInterceptor logging = new HttpLoggingInterceptor();            logging.setLevel(HttpLoggingInterceptor.Level.BODY);            OkHttpClient client = new OkHttpClient.Builder()                    .addInterceptor(logging)                    .addInterceptor(chain -> {                        Request.Builder builder = chain.request().newBuilder();                        if (authToken != null) {                            builder.addHeader("Authorization", "Bearer " + authToken);                        }                        return chain.proceed(builder.build());                    })                    .build();            Retrofit retrofit = new Retrofit.Builder()                    .baseUrl(BASE_URL)                    .client(client)                    .addConverterFactory(GsonConverterFactory.create())                    .build();            apiService = retrofit.create(ApiService.class);        }        return apiService;    }    public static void setToken(Context context, String token) {        authToken = token;        apiService = null; // пересоздаём с новым токеном        SharedPreferences prefs = context.getSharedPreferences("auth", Context.MODE_PRIVATE);        prefs.edit().putString("token", token).apply();    }    public static String getToken() {        return authToken;    }    public static void clearToken(Context context) {        authToken = null;        apiService = null;        SharedPreferences prefs = context.getSharedPreferences("auth", Context.MODE_PRIVATE);        prefs.edit().remove("token").apply();    }    public static boolean isLoggedIn() {        return authToken != null;    }}