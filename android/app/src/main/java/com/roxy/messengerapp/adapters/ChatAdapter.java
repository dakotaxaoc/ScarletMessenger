package com.roxy.messengerapp.adapters;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.TextView;import androidx.annotation.NonNull;import androidx.recyclerview.widget.RecyclerView;import com.bumptech.glide.Glide;import com.roxy.messengerapp.R;import com.roxy.messengerapp.entities.Chat;import com.roxy.messengerapp.entities.Message;import com.roxy.messengerapp.entities.User;import java.util.List;import de.hdodenhof.circleimageview.CircleImageView;public class ChatAdapter extends RecyclerView.Adapter<ChatAdapter.ViewHolder> {    private List<Chat> chatList;    private String currentUserId;    private OnChatClickListener listener;    public interface OnChatClickListener {        void onChatClick(Chat chat);    }    public ChatAdapter(List<Chat> chatList, String currentUserId, OnChatClickListener listener) {        this.chatList = chatList;        this.currentUserId = currentUserId;        this.listener = listener;    }    @NonNull    @Override    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {        View view = LayoutInflater.from(parent.getContext())                .inflate(R.layout.user_item, parent, false);        return new ViewHolder(view);    }    @Override    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {        Chat chat = chatList.get(position);        if (chat.getType().equals("private")) {            User otherUser = chat.getOtherUser(currentUserId);            if (otherUser != null) {                holder.username.setText(otherUser.getUsername());                // Аватар                if (otherUser.getImageURL() == null || otherUser.getImageURL().isEmpty()) {                    holder.profileImage.setImageResource(R.drawable.ic_profile_pic);                } else {                    Glide.with(holder.itemView.getContext())                            .load(otherUser.getImageURL())                            .into(holder.profileImage);                }                // Онлайн/офлайн                if (otherUser.isOnline()) {                    holder.imgOn.setVisibility(View.VISIBLE);                    holder.imgOff.setVisibility(View.GONE);                } else {                    holder.imgOn.setVisibility(View.GONE);                    holder.imgOff.setVisibility(View.VISIBLE);                }            }        } else {            // Групповой чат            holder.username.setText(chat.getName());            holder.imgOn.setVisibility(View.GONE);            holder.imgOff.setVisibility(View.GONE);            if (chat.getAvatar() != null && !chat.getAvatar().isEmpty()) {                Glide.with(holder.itemView.getContext())                        .load(chat.getAvatar())                        .into(holder.profileImage);            } else {                holder.profileImage.setImageResource(R.drawable.ic_profile_pic);            }        }        // Последнее сообщение        Message lastMessage = chat.getLastMessage();        if (lastMessage != null) {            String preview = lastMessage.getContent();            if (preview.length() > 35) {                preview = preview.substring(0, 35) + "...";            }            holder.lastMsg.setText(preview);            holder.lastMsg.setVisibility(View.VISIBLE);        } else {            holder.lastMsg.setText("Нет сообщений");            holder.lastMsg.setVisibility(View.VISIBLE);        }        // Клик        holder.itemView.setOnClickListener(v -> {            if (listener != null) {                listener.onChatClick(chat);            }        });    }    @Override    public int getItemCount() {        return chatList.size();    }    public Chat getChatAt(int position) {        return chatList.get(position);    }    public void removeChat(int position) {        chatList.remove(position);        notifyItemRemoved(position);    }    public static class ViewHolder extends RecyclerView.ViewHolder {        CircleImageView profileImage;        TextView username;        TextView lastMsg;        View imgOn;        View imgOff;        public ViewHolder(@NonNull View itemView) {            super(itemView);            profileImage = itemView.findViewById(R.id.ivUserAvatar);            username = itemView.findViewById(R.id.tvUserName);            lastMsg = itemView.findViewById(R.id.last_msg);            imgOn = itemView.findViewById(R.id.img_on);            imgOff = itemView.findViewById(R.id.img_off);        }    }}